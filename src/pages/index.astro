---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';
import { Card, CardGrid } from '@astrojs/starlight/components';
import { getCollection } from 'astro:content'; // 追加
import myLogo from '../assets/my-logo.jpg';

// docsコレクションから 'notes/' ディレクトリのファイルを取得
const allNotes = await getCollection('docs', ({ id }) => {
  return id.startsWith('notes/');
});

// アルファベット順や日付順でソート（ここでは最初の1件を取得）
// ファイル名が 2024-01-01.md のような形式なら sort() で最新が取れます
const firstNote = allNotes.sort().reverse()[0];

// リンクを動的に生成（ファイルが存在しない場合のフォールバックも設定）
const dynamicLink = firstNote ? `/${firstNote.slug}/` : '/notes/';
---

<StarlightPage frontmatter={{ 
	title: 'My CCNA Notes', 
	tagline: 'CCNA資格関連の勉強計画や学習ログ・技術メモ',
	template: 'splash',
	hero: {
		title: 'ミドルシニアのCCNAの勉強ノート',
		tagline: 'アラフィフの元ソフトウェアSEが学んだこと個人メモです。',
		image: {
		  file: myLogo,
		},
		actions: [
			{
				text: 'ノートを読む',
				link: dynamicLink, // ここを動的変数に変更
				icon: 'right-arrow',
				variant: 'primary',
			},
			{
				text: 'GitHubで見る',
				link: 'https://github.com/githubnishimura/my-CCNA-notes',
				icon: 'external',
			},
		],
	},
}}>

<CardGrid>
	<Card title="最新のネットワーク技術" icon="pencil">
		OSI参照モデルからルーティング、最新のワイヤレス技術まで。
	</Card>
	<Card title="コマンド備忘録" icon="add-document">
		Cisco IOSコマンドを体系的に整理。
	</Card>
	<Card title="試験対策" icon="setting">
		自身の弱点克服や、間違えやすいポイントのまとめ。
	</Card>
	<Card title="学習進捗" icon="rocket">
		合格までのロードマップ。
	</Card>
</CardGrid>

</StarlightPage>
